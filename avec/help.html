<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Aide - Test audio/micro</title>

    <!-- Typographie Poppins -->
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,400;0,700;1,400&display=swap"
      rel="stylesheet"
    />

    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>

    <style>
      body {
        font-family: "Poppins", sans-serif;
      }
    </style>
  </head>

  <body class="bg-[#EFE7E0] text-[#0E222D]">
    <section
      class="min-h-screen flex flex-col justify-center items-center px-4 py-10 text-center"
    >
      <h1 class="text-3xl sm:text-5xl font-bold mb-6 text-[#0E222D]">
        Aide & V√©rification des autorisations
      </h1>

      <p class="text-lg text-[#0E222D] mb-4 max-w-2xl">
        V√©rifiez que l'application a bien acc√®s √† votre
        <strong>microphone</strong> et vos <strong>enceintes</strong>. Si vous
        √™tes sur PC, assurez-vous d'avoir un micro et des enceintes
        fonctionnels. Sur mobile, v√©rifiez les permissions dans les param√®tres.
      </p>

      <!-- Test Micro -->
      <button
        id="testMic"
        class="mt-6 mb-2 px-6 py-3 bg-[#52B4BD] text-white rounded-xl shadow hover:bg-[#0E222D] flex items-center gap-2"
      >
        <i data-lucide="mic"></i> Tester le micro
      </button>
      <div id="micStatus" class="text-sm text-[#607D8B] mb-6"></div>

      <!-- Test Enceintes -->
      <button
        id="testSound"
        class="mb-2 px-6 py-3 bg-[#607D8B] text-white rounded-xl shadow hover:bg-[#0E222D] flex items-center gap-2"
      >
        <i data-lucide="volume-2"></i> Tester les enceintes
      </button>
      <div id="audioStatus" class="text-sm text-[#607D8B] mb-10"></div>

      <!-- Tutoriels -->
      <h2 class="text-xl font-semibold mb-4">
        Tutoriel pour activer le micro :
      </h2>
      <div
        id="browserHelp"
        class="text-left bg-white p-6 rounded-xl shadow max-w-xl text-[#0E222D] space-y-3"
      >
        <p>Chargement du tutoriel en fonction de votre navigateur...</p>
      </div>

      <div class="mt-8">
        <a
          href="/experience.html"
          class="inline-flex items-center px-6 py-3 bg-[#52B4BD] text-white text-lg font-semibold rounded-2xl shadow hover:bg-[#0E222D] transition"
        >
          <i data-lucide="rocket" class="w-5 h-5 mr-2"></i>
          Aller √† la page de cr√©ation de compte
        </a>
      </div>
    </section>

    <!-- Script -->
    <script>
      lucide.createIcons();

      const micBtn = document.getElementById("testMic");
      const micStatus = document.getElementById("micStatus");
      micBtn.addEventListener("click", async () => {
        micStatus.textContent = "Test du micro en cours...";
        try {
          const stream = await navigator.mediaDevices.getUserMedia({
            audio: true,
          });
          micStatus.textContent = "‚úÖ Micro d√©tect√© et autoris√© !";
          stream.getTracks().forEach((track) => track.stop());
        } catch (err) {
          micStatus.textContent = "‚ùå Micro non autoris√© ou non d√©tect√©.";
        }
      });

      const soundBtn = document.getElementById("testSound");
      const audioStatus = document.getElementById("audioStatus");
      soundBtn.addEventListener("click", () => {
        const audio = new Audio(
          "https://www.soundjay.com/button/sounds/button-3.mp3"
        );
        audio
          .play()
          .then(() => {
            audioStatus.textContent = "üîä Son jou√© avec succ√®s.";
          })
          .catch(() => {
            audioStatus.textContent = "‚ùå Impossible de jouer un son.";
          });
      });

      // Tutoriels navigateurs
      const helpBox = document.getElementById("browserHelp");
      const ua = navigator.userAgent;

      let tuto = "";
      if (/Chrome/.test(ua)) {
        tuto = `
          <strong>Google Chrome :</strong>
          <ul class="list-disc ml-6 space-y-1">
            <li>Cliquez sur l'ic√¥ne du cadenas üîí √† gauche de l'URL.</li>
            <li>Autorisez le microphone dans les param√®tres du site.</li>
            <li>Rechargez la page si n√©cessaire.</li>
          </ul>`;
      } else if (/Firefox/.test(ua)) {
        tuto = `
          <strong>Mozilla Firefox :</strong>
          <ul class="list-disc ml-6 space-y-1">
            <li>Une ic√¥ne de micro appara√Æt dans la barre d‚Äôadresse.</li>
            <li>Cliquez dessus et autorisez l‚Äôacc√®s au micro.</li>
            <li>V√©rifiez vos param√®tres de confidentialit√© si besoin.</li>
          </ul>`;
      } else if (/Safari/.test(ua)) {
        tuto = `
          <strong>Safari (Mac) :</strong>
          <ul class="list-disc ml-6 space-y-1">
            <li>Pr√©f√©rences Safari > Sites web > Microphone.</li>
            <li>Autorisez le micro pour ce site.</li>
          </ul>`;
      } else if (/Edg/.test(ua)) {
        tuto = `
          <strong>Microsoft Edge :</strong>
          <ul class="list-disc ml-6 space-y-1">
            <li>Cliquez sur l‚Äôic√¥ne de cadenas dans la barre d‚ÄôURL.</li>
            <li>Activez le micro dans les param√®tres du site.</li>
          </ul>`;
      } else {
        tuto = `<p>Votre navigateur n‚Äôest pas reconnu. Veuillez v√©rifier les param√®tres de permissions.</p>`;
      }

      helpBox.innerHTML = tuto;
    </script>
  </body>
</html>
